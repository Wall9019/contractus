<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Assistente Jurídico de Contratos Sociais</title>

    <!-- Bootstrap CSS (CDN) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- PDF.js (CDN) -->
    <script
      src="https://cdn.jsdelivr.net/npm/pdfjs-dist@2.13.216/build/pdf.js"
      defer
    ></script>

    <!-- Mammoth.js local (incluso neste projeto, minificado) -->
    <script src="./mammoth.min.js" defer></script>

    <!-- pdf-worker.js (local) -->
    <script src="./pdf-worker.js" defer></script>

    <script>
      // Define o worker do PDF.js para o arquivo local (pdf-worker.js)
      window.addEventListener('DOMContentLoaded', () => {
        pdfjsLib.GlobalWorkerOptions.workerSrc = './pdf-worker.js';
      });
    </script>
  </head>

  <body class="bg-light text-dark">
    <!-- Cabeçalho -->
    <header class="bg-white shadow p-4 text-center">
      <h1 class="h2 fw-bold">Assistente Jurídico de Contratos Sociais</h1>
      <p class="text-secondary mb-0">
        Análise automatizada de contratos (PDF/Word) usando ChatGPT
      </p>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container py-4">
      <!-- Seção de Botões Iniciais -->
      <section id="home-section" class="my-4 text-center">
        <!-- Botão para Upload de Documento -->
        <div class="mb-3">
          <label for="fileInput" class="btn btn-primary">
            Carregar Documento (PDF/Word)
          </label>
          <input
            id="fileInput"
            type="file"
            accept=".pdf,.doc,.docx"
            class="d-none"
          />
        </div>

        <!-- Botão para Inserir Texto Manualmente -->
        <div class="mb-3">
          <button id="manualButton" class="btn btn-success">
            Inserir Texto Manualmente
          </button>
        </div>

        <!-- Link "Saiba Mais" -->
        <a
          href="#about-section"
          class="text-decoration-underline text-info"
        >
          Saiba Mais
        </a>
      </section>

      <!-- Seção de Editor de Texto Manual -->
      <section
        id="manual-section"
        class="my-4 border border-2 p-3 rounded bg-white d-none"
      >
        <h2 class="h4 fw-semibold mb-3">Editor de Texto Manual</h2>
        <textarea
          id="manualTextArea"
          rows="8"
          class="form-control mb-3"
          placeholder="Cole aqui o conteúdo do contrato ou digite manualmente..."
        ></textarea>
        <div>
          <button
            id="analyzeManualBtn"
            class="btn btn-primary"
          >
            Iniciar Análise
          </button>
        </div>
      </section>

      <!-- Seção de Progresso -->
      <section id="loading-section" class="my-4 text-center d-none">
        <p class="fs-5">
          <span
            class="spinner-border spinner-border-sm"
            role="status"
            aria-hidden="true"
          ></span>
          Analisando documento, aguarde...
        </p>
      </section>

      <!-- Seção de Resultados da Análise -->
      <section
        id="results-section"
        class="my-4 border border-2 p-3 rounded bg-white d-none"
      >
        <h2 class="h4 fw-semibold mb-3">Resultados da Análise</h2>
        <div id="analysis-results" class="mb-3 text-body" style="white-space: pre-wrap;"></div>
        <!-- Botões de ação -->
        <div class="d-flex flex-column flex-sm-row gap-2">
          <button
            id="downloadReportBtn"
            class="btn btn-success"
          >
            Baixar Relatório
          </button>
          <button
            id="newAnalysisBtn"
            class="btn btn-secondary"
          >
            Nova Análise
          </button>
        </div>
      </section>

      <!-- Seção "Saiba Mais" -->
      <section id="about-section" class="my-4 p-3 rounded bg-white">
        <h2 class="h4 fw-semibold mb-2">Como Funciona?</h2>
        <p class="mb-0">
          Esta aplicação faz análise de documentos (PDF/Word) ou texto digitado
          manualmente, usando a API do ChatGPT para identificar possíveis lacunas
          ou inconsistências em contratos sociais. Basta carregar seu documento ou
          colar o texto do contrato e clicar em "Iniciar Análise".
        </p>
      </section>
    </main>

    <!-- Script Principal -->
    <script src="script.js"></script>

    <!-- Bootstrap JS (CDN) -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      defer
    ></script>
  </body>
</html>
